{"version":3,"sources":["../../../src/api/controller/sysinfo.js"],"names":["UID","require","DateFormat","db","dbpermission","getAction","id","success","params","get","sysid","fail","model","where","select","list","postAction","param","post","key","model_sysinfo","add","type","desc","putAction","update","insertId","deleteAction"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;AAGA;;;;AACA;;;;;;AAHA,IAAIA,MAAMC,QAAQ,WAAR,CAAV;AACA,IAAIC,aAAaD,QAAQ,YAAR,CAAjB;;AAGA,IAAME,KAAK,aAAGC,YAAd;;;;;;;;;;qBAGUC,S;;;;;;;iCAEC,KAAKC,E;;;;;6DACG,KAAKC,OAAL,CAAa,MAAb,C;;;AAKHC,kC,GAAc,KAAKC,GAAL,MAAc,E,EAC5BH,E,GAAcE,OAAOE,K;;gCAErBJ,E;;;;;6DACO,KAAKK,IAAL,CAAU,CAAC,CAAX,EAAa,eAAb,C;;;AAGPC,iC,GAAQ,KAAKA,KAAL,CAAW,SAAX,EAAqBT,EAArB,C;;mCACKS,MAAMC,KAAN,CAAY,EAACH,OAAMJ,EAAP,EAAZ,EAAwBQ,MAAxB,E;;;AAAbC,gC;6DACG,KAAKR,OAAL,CAAaQ,IAAb,C;;;;;;;;;;;;;;;;;AAIf;;;qBACMC,U;;;;;;;AACEC,iC,GAAQ,KAAKC,IAAL,E;AACRR,iC,GAAQO,MAAMP,K,EACdS,G,GAAMF,MAAME,G;;kCAEb,CAACT,KAAD,IAAU,CAACS,G;;;;;8DACH,KAAKR,IAAL,CAAU,CAAC,CAAX,EAAc,OAAd,C;;;AAEPS,yC,GAAgB,KAAKR,KAAL,CAAW,SAAX,EAAqBT,EAArB,C;;mCACdiB,cAAcC,GAAd,CAAkB;AACpBX,uCAAQA,KADY;AAEpBY,sCAAOL,MAAMK,IAAN,IAAc,CAFD;AAGpBH,qCAAMF,MAAME,GAAN,IAAa,EAHC;AAIpBI,sCAAON,MAAMM,IAAN,IAAc;AAJD,6BAAlB,C;;;8DAMC,KAAKhB,OAAL,CAAa,OAAb,C;;;;;;;;;;;;;;;;;AAGX;;;qBACMiB,S;;;;;;;gCACE,KAAKlB,E;;;;;8DACE,KAAKK,IAAL,CAAU,OAAV,C;;;AAGPM,iC,GAAQ,KAAKC,IAAL,E;AACRZ,8B,GAAKW,MAAMX,E,EAAIa,G,GAAMF,MAAME,G,EAAKT,K,GAAQO,MAAMP,K;;kCAC/C,CAACS,GAAD,IAAQ,CAACT,K;;;;;8DACD,KAAKC,IAAL,CAAU,CAAC,CAAX,EAAc,OAAd,C;;;AAEPS,yC,GAAgB,KAAKR,KAAL,CAAW,SAAX,EAAqBT,EAArB,C;;mCAECiB,cAAcP,KAAd,CAAoB,EAACH,OAAOA,KAAR,EAAeJ,IAAGA,EAAlB,EAApB,EAA2CmB,MAA3C,CAAkD;AACnEN,qCAAMF,MAAME,GAAN,IAAa,EADgD;AAEnEG,sCAAOL,MAAMK,IAAN,IAAc,CAF8C;AAGnEC,sCAAON,MAAMM,IAAN,IAAc;AAH8C,6BAAlD,C;;;AAAjBG,oC;8DAKG,KAAKnB,OAAL,CAAa,MAAb,C;;;;;;;;;;;;;;;;;qBAGLoB,Y;;;;;;8DAmBK,KAAKpB,OAAL,CAAa,OAAb,C","file":"sysinfo.js","sourcesContent":["'use strict';\nlet UID = require('node-uuid');\nlet DateFormat = require('dateformat');\nimport Base from './baserest.js';\nimport DB from '../../db.js';\nconst db = DB.dbpermission;\n\nexport default class extends Base {\n    async getAction(){\n        //获取信息\n        if(this.id){\n            return this.success('data');\n        }\n        // 获取列表\n        else{\n\n            let params      = this.get() || {},\n                id          = params.sysid;\n\n            if(!id){\n                return this.fail(-1,'参数错误：sysid为空！');\n            }\n\n            let model = this.model('sysinfo',db);\n            let list = await model.where({sysid:id}).select();\n            return this.success(list);\n        }\n    }\n\n    // 添加一条数据\n    async postAction(){\n        let param = this.post();\n        let sysid = param.sysid,\n            key = param.key;\n\n        if(!sysid || !key){\n            return this.fail(-1 ,'参数不正确');\n        }\n        let model_sysinfo = this.model('sysinfo',db);\n        await model_sysinfo.add({\n            sysid : sysid,\n            type : param.type || 1,\n            key : param.key || '',\n            desc : param.desc || '',\n        })\n        return this.success('添加成功！');\n    }\n\n    // 修改一条数据\n    async putAction(){\n        if(!this.id){\n            return this.fail('id为空！');\n        }\n\n        let param = this.post();\n        let id = param.id, key = param.key ,sysid = param.sysid;\n        if(!key || !sysid){\n            return this.fail(-1 ,'参数不正确');\n        }\n        let model_sysinfo = this.model('sysinfo',db);\n\n        let insertId = await model_sysinfo.where({sysid: sysid ,id:id}).update({\n            key : param.key || '',\n            type : param.type || 1,\n            desc : param.desc || '',\n        });\n        return this.success('修改成功');\n    }\n\n    async deleteAction(){\n        // let uid = this.id;\n        // if (!uid) return this.fail('id为空！');\n        // // 需要删除 课程表、课程目录表、课程内容表、课程结构表、课程分享表、试题表、纠错表\n        // let model_course = this.model('course',db),\n        //     model_coursecatalog = this.model('coursecatalog',db),\n        //     model_coursecontent = this.model('coursecontent',db),\n        //     model_coursemind = this.model('coursemind',db),\n        //     model_courseshare = this.model('courseshare',db),\n        //     model_question = this.model('question',db),\n        //     model_buglog = this.model('buglog',db);\n\n        // model_course.delete({where: {uid: uid } });\n        // model_coursemind.delete({where: {cuid: uid } });\n        // model_coursecatalog.delete({where: {cuid: uid } });\n        // model_coursecontent.delete({where: {cuid: uid } });\n        // model_courseshare.delete({where: {cuid: uid } });\n        // model_question.delete({where: {cuid: uid } });\n        // model_buglog.delete({where: {cuid: uid } });\n        return this.success('删除成功！');\n    }\n}"]}