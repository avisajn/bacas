{"version":3,"sources":["../../../src/activity/controller/valentine.js"],"names":["db","activity","createAction","fail","model","add","userid","w1","w2","w3","w4","id","success","setAction","obj","type","status","format","where","update","getAction","res","length","getlistAction"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,KAAK,aAAGC,QAAd;;;;;;;;;;AAII;qBACMC,Y;;;;;;;6DACK,KAAKC,IAAL,CAAU,CAAC,CAAX,EAAc,WAAd,C;;;AAMHC,iC,GAAQ,KAAKA,KAAL,CAAW,WAAX,EAAwBJ,EAAxB,C;;mCACKI,MAAMC,GAAN,CAAU,EAACC,cAAD,EAASC,IAAG,CAAZ,EAAcC,IAAG,CAAjB,EAAmBC,IAAG,CAAtB,EAAwBC,IAAG,CAA3B,EAAV,C;;;AAAXC,8B;;iCACHA,E;;;;;6DACQ,KAAKC,OAAL,CAAaD,EAAb,C;;;6DAEA,KAAKR,IAAL,CAAU,CAAC,CAAX,EAAcQ,EAAd,C;;;;;;;;;;;;;;;;;qBAITE,S;;;;;;;8DACK,KAAKV,IAAL,CAAU,CAAC,CAAX,EAAc,WAAd,C;;;AAQHC,iC,GAAQ,KAAKA,KAAL,CAAW,WAAX,EAAwBJ,EAAxB,C;AACNc,+B,GAAM,E;;AACZA,gCAAI,MAAIC,IAAR,IAAgBC,MAAhB;AACA,gCAAGA,UAAU,CAAb,EAAe;AACXF,oCAAI,MAAIC,IAAJ,GAAS,OAAb,IAAwB,EAAxB;AACH,6BAFD,MAEK;AACDD,oCAAI,MAAIC,IAAJ,GAAS,OAAb,IAAwB,wBAASE,MAAT,CAAgB,qBAAhB,CAAxB;AACH;;mCACgBb,MAAMc,KAAN,CAAY,EAACZ,cAAD,EAAZ,EAAsBa,MAAtB,CAA6BL,GAA7B,C;;;AAAXH,8B;;iCACHA,E;;;;;8DACQ,KAAKC,OAAL,CAAaD,EAAb,C;;;8DAEA,KAAKR,IAAL,CAAU,CAAC,CAAX,EAAcQ,EAAd,C;;;;;;;;;;;;;;;;;qBAITS,S;;;;;;;8DACK,KAAKjB,IAAL,CAAU,CAAC,CAAX,EAAc,WAAd,C;;;AAKHkB,+B;;kCACDA,IAAIC,MAAJ,GAAa,C;;;;;8DACL,KAAKV,OAAL,CAAaS,IAAI,CAAJ,CAAb,C;;;8DAEJ,KAAKlB,IAAL,CAAU,CAAC,CAAX,C;;;;;;;;;;;;;;;;;qBAILoB,a;;;;;;;8DACK,KAAKpB,IAAL,CAAU,CAAC,CAAX,EAAc,WAAd,C;;;AAEHkB,+B;8DACG,KAAKT,OAAL,CAAaS,GAAb,C","file":"valentine.js","sourcesContent":["'use strict';\nimport moment from 'moment';\nimport Base from './base.js';\nimport DB from '../../db.js';\n\nconst db = DB.activity;\n\nexport default class extends Base {\n\n    // 返回所有的发布人\n    async createAction(){\n        return this.fail(-1 ,'not allow'); \n        let param = this.post();\n        let userid    = param.userid;\n\n        if(!userid ){return this.fail(-1 ,'参数不正确'); }\n\n        let model = this.model('valentine' ,db);\n        const id = await model.add({userid ,w1:0,w2:0,w3:0,w4:0 });\n        if(id){\n            return this.success(id);\n        }else{\n            return this.fail(-1 ,id);\n        }\n    }\n\n    async setAction(){\n        return this.fail(-1 ,'not allow'); \n        let param   = this.post();\n        let userid  = param.userid,\n            type    = param.type,\n            status    = param.status;\n\n        if(!userid || !type){return this.fail(-1 ,'参数不正确'); }\n\n        let model = this.model('valentine' ,db);\n        const obj = {};\n        obj['w'+type] = status;\n        if(status == 0){\n            obj['w'+type+'_time'] = '';\n        }else{\n            obj['w'+type+'_time'] = moment().format('YYYY-MM-DD HH:mm:ss');\n        }\n        const id = await model.where({userid}).update(obj);\n        if(id){\n            return this.success(id);\n        }else{\n            return this.fail(-1 ,id);\n        }\n    }\n\n    async getAction(){\n        return this.fail(-1 ,'not allow'); \n        let params      = this.get() || {},\n            userid     = params.userid || 1;\n\n        let model = this.model('valentine' ,db);\n        let res = await model.field('w1,w2,w3,w4').where(\"userid='\"+userid+\"'\").select();\n        if(res.length > 0){\n            return this.success(res[0]);\n        }\n        return this.fail(-1);\n    }\n\n\n    async getlistAction(){\n        return this.fail(-1 ,'not allow'); \n        let model = this.model('valentine' ,db);\n        let res = await model.field('userid,w1,w1_time,w2,w2_time,w3,w3_time,w4,w4_time').order('id desc').select();\n        return this.success(res);\n    }\n}   "]}