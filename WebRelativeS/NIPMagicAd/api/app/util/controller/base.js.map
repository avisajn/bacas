{"version":3,"sources":["../../../src/util/controller/base.js"],"names":["__before","allowAccessOrigin","http","headers","origin","header","_userInfo","userid","fail","getUser","getUserId","think","env","STATICURL","controller","base"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGE;;;;mBAIMA,Q;;;;;;;;AAEEC,+B,GAAoB,KAAKC,IAAL,CAAUC,OAAV,CAAkBC,M;;;AAE5C,mBAAKC,MAAL,CAAY,6BAAZ,EAA2CJ,iBAA3C;AACA,mBAAKI,MAAL,CAAY,8BAAZ,EAA4C,qEAA5C;AACA,mBAAKA,MAAL,CAAY,8BAAZ,EAA4C,iCAA5C;AACA,mBAAKA,MAAL,CAAY,kCAAZ,EAAgD,MAAhD;;AAEA;AACA;;AAEA;AACE;AACF;;AAEA;AACA;AACA;AACIC,uB,GAAY,EAACC,QAAO,CAAR,E;;oBAGb,CAACD,SAAD,IAAc,CAACA,UAAUC,M;;;;;+CACnB,KAAKC,IAAL,CAAU,CAAC,CAAX,EAAc,UAAd,C;;;;AAGT,mBAAKC,OAAL,GAAe,YAAU;AACvB,uBAAOH,SAAP;AACD,eAFD;;AAIA,mBAAKI,SAAL,GAAiB,YAAU;AACvB,uBAAOJ,UAAUC,MAAjB;AACH,eAFD;;AAIA,kBAAGI,MAAMC,GAAN,IAAa,aAAhB,EAA8B;AAC5B,qBAAKC,SAAL,GAAe,EAAf;AACD,eAFD,MAEK;AACH,qBAAKA,SAAL,GAAe,0BAAf;AACD;;;;;;;;;;;;;;;;;;EA3CwBF,MAAMG,UAAN,CAAiBC,I","file":"base.js","sourcesContent":["'use strict';\n\nexport default class extends think.controller.base {\n  /**\n   * some base method in here\n   */\n  \n  async __before() {\n\n    const allowAccessOrigin = this.http.headers.origin;\n\n    this.header('Access-Control-Allow-Origin', allowAccessOrigin);\n    this.header('Access-Control-Allow-Headers', 'Content-Type,Content-Length, Authorization, Accept,X-Requested-With');\n    this.header('Access-Control-Allow-Methods', \"GET, POST, PUT, DELETE, OPTIONS\");\n    this.header('Access-Control-Allow-Credentials', 'true');\n\n    // return ;\n    // let ciphertext = this.cookie(\"token\");\n\n    // if(!ciphertext){\n      // return this.fail(-2, '未登录！');\n    // }\n\n    // 解密\n    // let bytes  = CryptoJS.AES.decrypt(ciphertext, crypKey);\n    // let _userInfo = JSON.parse(bytes.toString(CryptoJS.enc.Utf8));\n    let _userInfo = {userid:1}\n\n\n    if(!_userInfo || !_userInfo.userid){\n      return this.fail(-2 ,'登录信息不正确！');\n    }\n\n    this.getUser = function(){\n      return _userInfo;\n    }\n\n    this.getUserId = function(){\n        return _userInfo.userid;\n    }\n\n    if(think.env == 'development'){\n      this.STATICURL='';\n    }else{\n      this.STATICURL='http://static.ymark.wang';\n    }\n  }\n}"]}