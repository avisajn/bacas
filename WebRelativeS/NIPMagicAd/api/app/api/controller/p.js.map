{"version":3,"sources":["../../../src/api/controller/p.js"],"names":["indexAction","http","method","fail","sysId","get","sysid","rids","getRids","model","field","alias","join","where","select","list","user","getUser","success","country","username"],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;AACA;;;;;;;;;;;;;;AAEI;qBACMA,W;;;;;;;kCACC,KAAKC,IAAL,CAAUC,MAAV,IAAoB,M;;;;;6DAAe,KAAKC,IAAL,CAAU,CAAC,CAAX,EAAa,MAAb,C;;;AAChCC,iC,GAAQ,KAAKC,GAAL,GAAWC,K;AACnBC,gC,GAAO,KAAKC,OAAL,E;AACTC,iC,GAAQ,KAAKA,KAAL,CAAW,SAAX,C;;mCACKA,MAAMC,KAAN,CAAY,kBAAZ,EAAgCC,KAAhC,CAAsC,MAAtC,EACCC,IADD,CACM,CAAE,2BAAF,EAA8B,oCAA9B,CADN,EAECC,KAFD,CAEO,gBAAcN,IAAd,GAAmB,mBAAnB,GAAuCH,KAF9C,EAEqDU,MAFrD,E;;;AAAbC,gC;AAIEC,gC,GAAO,KAAKC,OAAL,E;6DACN,KAAKC,OAAL,CAAa;AAChBH,sCAAOA,IADS;AAEhBI,yCAAUH,KAAKG,OAFC;AAGhBC,0CAAWJ,KAAKI;AAHA,6BAAb,C","file":"p.js","sourcesContent":["'use strict';\nimport Base from './base.js';\nexport default class extends Base {\n    // 登录验证\n    async indexAction(){\n        if(this.http.method != 'POST'){return this.fail(-1,'参数错误'); }\n        const sysId = this.get().sysid;\n        const rids = this.getRids();\n        let model = this.model('rolesys');\n        let list = await model.field('si.`key`,si.type').alias('base')\n                         .join([ 'sys s on s.id=base.sysid ','sysinfo si on si.id=base.sysinfoid'])\n                         .where('roleid in ('+rids+') and base.sysid='+sysId).select();\n\n        const user = this.getUser();\n        return this.success({\n            list : list ,\n            country : user.country,\n            username : user.username\n        });\n    }\n\n}"]}